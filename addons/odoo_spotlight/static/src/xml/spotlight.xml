<?xml version="1.0" encoding="UTF-8"?>

<templates xml:space="preserve">
  <t t-name="odoo_spotlight.SpotlightPalette">
    <Dialog header="false" footer="false" size="'md'" contentClass="'o_spotlight_dialog'">
      <div t-ref="root">
        <div class="o_spotlight_search_header">
          <div class="o_spotlight_search_wrapper">
            <i class="fa fa-search o_spotlight_search_icon"></i>
            <input class="o_spotlight_search" t-att-value="state.searchValue" placeholder="Type a name, email, or reference..." t-ref="searchInput" t-on-input="onSearchInput" />
          </div>

          <div class="text-muted navigation_tip">Press <kbd class="mx-1">↵</kbd> to open full screen  |  Press <kbd class="mx-1">⇧ + ↵</kbd> to open in wizard</div>
        </div>

        <div class="o_spotlight_results position-relative overflow-auto">
          <i t-if="state.isLoading" title="Loading..." role="img" aria-label="Loading..." class="fa fa-spinner fa-spin" />

          <t t-if="!state.results.length and state.searchValue">
            <div class="o_command_palette_listbox_empty px-4 py-3 fst-italic">No results</div>
          </t>

          <t t-if="!state.searchValue">
            <div class="o_command_palette_listbox_empty px-4 py-3 fst-italic">Type something to start searching</div>
          </t>

          <t t-foreach="state.results" t-as="section" t-key="section.label + section.icon">
            <SpotlightSection t-props="{
              title: section.label,
              icon: section.icon,
              items: section.items,
              activeIndex: state.activeIndex
            }" />
          </t>
        </div>
        <div class="o_spotlight_footer px-4 py-2 border-top rounded-bottom bg-100 text-muted d-flex justify-content-between align-items-center">
          <div>
            <span class="fw-bolder text-primary">TIP</span>
            — Press <kbd>Tab</kbd> to switch to Odoo
            command palette
          </div>
          <div class="o_spotlight_quick_actions_container">
            <button
              type="button"
              class="btn btn-sm o_spotlight_quick_actions_button"
              t-att-disabled="!getActiveQuickActions().length"
              t-on-click="toggleQuickActions"
            >
              <i class="fa fa-bolt me-1" />
              <span>Actions <kbd>Ctrl + ;</kbd> </span> 
            </button>
            <t t-if="state.isQuickActionsOpen">
              <div class="o_spotlight_quick_actions_panel bg-white px-3 py-2">
                <div class="o_spotlight_quick_actions_header text-muted mb-1">
                  <span class="fw-bolder">Quick actions</span>
                  <t t-if="activeItem">
                    <span class="mx-1">·</span>
                    <span class="o_spotlight_quick_actions_item_label">
                      <t t-esc="activeItem.name or activeItem.display_name or activeItem.email" />
                    </span>
                  </t>
                </div>
                <ul class="list-unstyled mb-0 py-2 o_spotlight_quick_actions_list">
                  <t t-set="item" t-value="activeItem"/>
                  <t t-set="qaStruct" t-value="item and item.quickActions"/>

                  <t t-if="qaStruct and qaStruct.provider.length">
                    <t t-foreach="qaStruct.provider" t-as="qa" t-key="qa.id">
                      <li
                        t-att-class="{
                          'o_spotlight_quick_actions_item': true,
                          'active': getActiveQuickActions()[state.activeQuickActionIndex] === qa,
                          'o_spotlight_quick_actions_item_destructive': qa.isDestructive
                        }"
                        t-on-click="(ev) => onQuickActionClick(ev, getActiveQuickActions().indexOf(qa))"
                      >
                        <span class="d-flex align-items-center px-2">
                          <i t-if="qa.icon" t-att-class="'fa ' + qa.icon + ' me-2'" />
                          <span><t t-esc="qa.label" /></span>
                        </span>
                      </li>
                    </t>

                    <t t-if="qaStruct.common.length">
                      <li class="o_spotlight_quick_actions_separator"></li>
                    </t>
                  </t>

                  <t t-if="qaStruct">
                    <t t-foreach="qaStruct.common" t-as="qa" t-key="qa.id">
                      <li
                        t-att-class="{
                          'o_spotlight_quick_actions_item': true,
                          'active': getActiveQuickActions()[state.activeQuickActionIndex] === qa,
                          'o_spotlight_quick_actions_item_destructive': qa.isDestructive
                        }"
                        t-on-click="(ev) => onQuickActionClick(ev, getActiveQuickActions().indexOf(qa))"
                      >
                        <span class="d-flex align-items-center px-2">
                          <i t-if="qa.icon" t-att-class="'fa ' + qa.icon + ' me-2'" />
                          <span><t t-esc="qa.label" /></span>
                        </span>
                      </li>
                    </t>
                  </t>
                </ul>
              </div>
            </t>
          </div>
        </div>
      </div>
    </Dialog>
  </t>
</templates>
